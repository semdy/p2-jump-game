var city;!function(t){var i;!function(i){var e=function(){function i(){}var e=(__define,i);e.prototype;return i.extract=function(i,e){void 0===e&&(e=!1);var n=RES.getRes(i);if(void 0!=n)return n;if(!e)throw new Error("assets("+i+") doesn't exist!");t.utils.DevUtil.trace(this,"extract failed!"+i)},i.extractTxtrFromSheet=function(i,e,n){void 0===n&&(n=!1);var r=e.getTexture(i);if(void 0!=r)return r;if(!n)throw new Error("sheet assets("+i+") doesn't exist!");t.utils.DevUtil.trace(this,"extract failed!"+i)},i.toString=function(){return"[-StrongAssets-]"},i}();i.StrongAssets=e,egret.registerClass(e,"city.assets.StrongAssets")}(i=t.assets||(t.assets={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(t){function i(i){t.call(this,i)}__extends(i,t);var e=(__define,i),n=e.prototype;return n.toString=function(){return"[btn"+this.id.toString()+"]"},i}(egret.Bitmap);t.ButtonHasId=i,egret.registerClass(i,"city.disp.ButtonHasId")}(i=t.disp||(t.disp={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(t){function i(i){t.call(this);for(var e,n=0,r=0;r<i.length;++r)e=i[r],e.x=n,n+=e.width,t.prototype.addChild.call(this,e)}__extends(i,t);var e=(__define,i);e.prototype;return i}(egret.Sprite);t.ComplexTextLine=i,egret.registerClass(i,"city.disp.ComplexTextLine")}(i=t.disp||(t.disp={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(t){function i(i){t.call(this);for(var e=0,n=0;n<i.length;++n)i[n].width>e&&(e=i[n].width);for(var r=0,n=0;n<i.length;++n)i[n].x=(e-i[n].width)/2,i[n].y=r,r+=i[n].height,this.addChild(i[n])}__extends(i,t);var e=(__define,i);e.prototype;return i}(egret.Sprite);t.ComplexTextPara=i,egret.registerClass(i,"city.disp.ComplexTextPara")}(i=t.disp||(t.disp={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(t){function i(i,e){t.call(this),this.fontFamily="微软雅黑",this.textColor=e,this.size=40,this.text=i}__extends(i,t);var e=(__define,i);e.prototype;return i}(egret.TextField);t.ComplexTextUnit=i,egret.registerClass(i,"city.disp.ComplexTextUnit")}(i=t.disp||(t.disp={}))}(city||(city={}));var city;!function(t){var i;!function(i){var e=function(i){function e(t,e){i.call(this),this._w=t,this._h=e,this.createView()}__extends(e,i);var n=(__define,e),r=n.prototype;return e.$i=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=0),null==this._$i&&(this._$i=new e(t,i)),this._$i},r.createView=function(){this._icon=new egret.Bitmap,this.addChild(this._icon),this._tx=new egret.TextField,this.addChild(this._tx)},r.displayLoadingIcon=function(){var i=t.assets.StrongAssets.extract("loading",!0);i&&(this._icon.texture=i,this._icon.x=(this._w-this._icon.width)/2,this._icon.y=(this._h-this._icon.height)/2,this._tx.x=(this._w-this._tx.width)/2,this._tx.y=(this._h-this._tx.height)/2+this._icon.height+10)},r.setProgress=function(t,i){this._tx.text="努力加载中... "+Math.round(t/i*100)+"%",this._tx.x=(this._w-this._tx.width)/2,this._tx.y=(this._h-this._tx.height)/2+this._icon.height+10},e}(egret.Sprite);i.LoadingUI=e,egret.registerClass(e,"city.disp.LoadingUI")}(i=t.disp||(t.disp={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(t){function i(i,e){t.call(this),this.graphics.lineStyle(1,i),this.graphics.beginFill(e),this.graphics.drawRect(0,0,10,10),this.graphics.endFill()}__extends(i,t);var e=(__define,i);e.prototype;return i}(egret.Shape);t.Mark=i,egret.registerClass(i,"city.disp.Mark")}(i=t.disp||(t.disp={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(t){function i(){t.call(this)}__extends(i,t);var e=(__define,i),n=e.prototype;return n.toString=function(){return"[txbtn"+this.id.toString()+"]"},i}(egret.TextField);t.TxButtonHasId=i,egret.registerClass(i,"city.disp.TxButtonHasId")}(i=t.disp||(t.disp={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(){function t(){}var i=(__define,t);i.prototype;return t.init=function(){var t=this;document.onkeydown=function(i){t.onkeydown(i)},document.onkeyup=function(i){t.onkeyup(i)},this.dictKeyDn={}},t.isDown=function(t){return this.dictKeyDn[t]&&1==this.dictKeyDn[t]},t.onkeydown=function(t){var i=window.event?t.keyCode:t.which;this.dictKeyDn[i]=!0},t.onkeyup=function(t){var i=window.event?t.keyCode:t.which;this.dictKeyDn[i]=!1},t.Shift_L=16,t.Ctrl_L=17,t.Alt_L=18,t}();t.KeyManager=i,egret.registerClass(i,"city.key.KeyManager")}(i=t.key||(t.key={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(){function t(t,i){this.COLOR_D_SLEEP=10066329,this.COLOR_D_WAKE=15053490,this.COLOR_K=8355813,this.COLOR_S=8381823,this.world=t,this.sprite=i}var i=(__define,t),e=i.prototype;return e.drawDebug=function(){this.sprite.graphics.clear();var t=this.world.bodies.length;console.log("bodies.length:",t);for(var i=0;t>i;i++)for(var e=this.world.bodies[i],n=0;n<e.shapes.length;n++){var r=e.shapes[n];r instanceof p2.Convex?this.drawConvex(r,e):r instanceof p2.Circle?this.drawCircle(r,e):r instanceof p2.Line?this.drawLine(r,e):r instanceof p2.Particle?this.drawParticle(r,e):r instanceof p2.Plane?this.drawPlane(r,e):r instanceof p2.Capsule&&this.drawCapsule(r,e)}},e.drawCircle=function(t,i){var e=this.getColor(i),n=this.sprite.graphics;n.lineStyle(1,e),n.beginFill(e,.5),n.drawCircle(i.position[0],i.position[1],t.radius);var r=new Array;i.toWorldFrame(r,[t.radius,0]),n.moveTo(i.position[0],i.position[1]),n.lineTo(r[0],r[1]),n.endFill()},e.drawCapsule=function(t,i){var e=this.getColor(i),n=t.length,r=t.radius,s=new Array,o=new Array,a=new Array,c=new Array,h=new Array,l=new Array;i.toWorldFrame(s,[-n/2,-r]),i.toWorldFrame(o,[n/2,-r]),i.toWorldFrame(a,[n/2,r]),i.toWorldFrame(c,[-n/2,r]),i.toWorldFrame(h,[n/2,0]),i.toWorldFrame(l,[-n/2,0]);var u=this.sprite.graphics;u.lineStyle(1,e),u.beginFill(e,.5),u.drawCircle(h[0],h[1],r),u.endFill(),u.lineStyle(1,e),u.beginFill(e,.5),u.drawCircle(l[0],l[1],r),u.endFill(),u.lineStyle(1,e),u.beginFill(e,.5),u.moveTo(s[0],s[1]),u.lineTo(o[0],o[1]),u.lineTo(a[0],a[1]),u.lineTo(c[0],c[1]),u.endFill()},e.drawLine=function(t,i){var e=this.getColor(i),n=t.length,r=new Array,s=new Array;i.toWorldFrame(r,[-n/2,0]),i.toWorldFrame(s,[n/2,0]);var o=this.sprite.graphics;o.lineStyle(1,e),o.moveTo(r[0],r[1]),o.lineTo(s[0],s[1]),o.endFill()},e.drawParticle=function(t,i){var e=this.getColor(i),n=this.sprite.graphics;n.lineStyle(1,e),n.beginFill(e,.5),n.drawCircle(i.position[0],i.position[1],1),n.endFill(),n.lineStyle(1,e),n.drawCircle(i.position[0],i.position[1],5),n.endFill()},e.drawConvex=function(t,i){var e=this.getColor(i),n=t.vertices.length,r=this.sprite.graphics;r.lineStyle(1,e),r.beginFill(e,.5);var s=new Array,o=new Array;i.toWorldFrame(o,t.vertices[0]),r.moveTo(i.position[0],i.position[1]),s.push(i.position[0],i.position[1]),r.lineTo(o[0],o[1]),s.push(o[0],o[1]);for(var a=1;n>=a;a++)i.toWorldFrame(o,t.vertices[a%n]),r.lineTo(o[0],o[1]),s.push(o[0],o[1]);r.endFill()},e.drawPlane=function(t,i){var e=this.COLOR_D_SLEEP,n=this.sprite.graphics;n.lineStyle(1,e),n.beginFill(e,1);var r=new Array,s=new Array;i.toWorldFrame(r,[-1e3,0]),n.moveTo(r[0],r[1]),i.toWorldFrame(s,[1e3,0]),n.lineTo(s[0],s[1]),i.toWorldFrame(s,[1e3,-1e3]),n.lineTo(s[0],s[1]),i.toWorldFrame(s,[-1e3,-1e3]),n.lineTo(s[0],s[1]),i.toWorldFrame(s,[-1e3,-0]),n.lineTo(s[0],s[1]),n.endFill()},e.getColor=function(t){var i=this.COLOR_D_SLEEP;return t.type==p2.Body.KINEMATIC?i=this.COLOR_K:t.type==p2.Body.STATIC?i=this.COLOR_S:t.sleepState==p2.Body.AWAKE&&(i=this.COLOR_D_WAKE),i},t}();t.P2DebugPainter=i,egret.registerClass(i,"city.phys.P2DebugPainter")}(i=t.phys||(t.phys={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(){function t(){}var i=(__define,t);i.prototype;return t.checkIfCanJump=function(t,i){for(var e=!1,n=0;n<t.narrowphase.contactEquations.length;n++){var r=t.narrowphase.contactEquations[n];if(r.bodyA===i||r.bodyB===i){var s=p2.vec2.dot(r.normalA,this.yAxis);r.bodyA===i&&(s*=-1),console.log("checkIfCanJump:",s),-.5>s&&(e=!0)}}return e},t.syncDisplay=function(i,e){if(void 0===e&&(e=""),i){var n=i.displays[0];if(n){var r=t.getEgretLoc(i,e);n.x=r[0],n.y=r[1],n.rotation=360-180*i.angle/Math.PI,e.length&&console.log(e+"的锚点",n.anchorOffsetX,n.anchorOffsetY)}}},t.extentEgret=function(t){return t*this.$factor},t.extentP2=function(t){return t/this.$factor},t.getP2Pos=function(t,i){return[t/this.$factor,i/this.$factor]},t.getEgretLoc=function(t,i){void 0===i&&(i="");var e=t.position[0],n=t.position[1];return i.length&&console.log("["+i+"]getEgretLoc:",e,n,"(p2->egret)",e*this.$factor,n*this.$factor),[e*this.$factor,n*this.$factor]},t.initSpace=function(t,i){this.$factor=t,this._rectWorld=i},t.yAxis=p2.vec2.fromValues(0,1),t}();t.P2Space=i,egret.registerClass(i,"city.phys.P2Space")}(i=t.phys||(t.phys={}))}(city||(city={}));var city;!function(t){var i;!function(i){var e=function(){function e(){}var n=(__define,e);n.prototype;return e.addTarget=function(e,n,r,s){null==this._dictName2TriggerUnit&&(this._dictName2TriggerUnit=new Object,egret.Ticker.getInstance().register(this.advance,this)),null==this._vcActiveName&&(this._vcActiveName=new Array),this.register(r,s),e.name=t.utils.Namer.getOne,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this),e.addEventListener(egret.TouchEvent.TOUCH_END,this.touchHandler,this),this._dictName2TriggerUnit[e.name]=new i.TouchTriggerUnit(n),console.log("addTarget:",this._dictName2TriggerUnit[e.name])},e.touchHandler=function(t){var i=t.currentTarget.name,e=this._dictName2TriggerUnit[i];switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:e.startTime(egret.getTimer()),this._vcActiveName.push(i);break;case egret.TouchEvent.TOUCH_END:this._vcActiveName.splice(this._vcActiveName.indexOf(i))}},e.advance=function(t){if(this._vcActiveName.length){var i=egret.getTimer();for(var e in this._vcActiveName){var n=this._dictName2TriggerUnit[this._vcActiveName[e]];if(n.checkAndUpdateTrigger(i))for(var r=this._vcHandler.length-1;r>-1;--r)this._vcHandler[r].apply(this._vcHostHandler[r],[n.id])}}},e.register=function(t,i){null==this._vcHandler&&(this._vcHandler=new Array,this._vcHostHandler=new Array),(-1==this._vcHandler.indexOf(t)||this._vcHandler.indexOf(t)!=this._vcHostHandler.indexOf(i))&&(this._vcHandler.push(t),this._vcHostHandler.push(i))},e}();i.TouchTriggerCenter=e,egret.registerClass(e,"city.touch.TouchTriggerCenter")}(i=t.touch||(t.touch={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(){function t(t){this.id=t}var i=(__define,t),e=i.prototype;return e.startTime=function(i){this.tmNextTrigger=i+t.tmDelayFirstTrigger},e.checkAndUpdateTrigger=function(i){return console.log("checkAndUpdateTrigger:",i,this.tmNextTrigger),i>this.tmNextTrigger?(this.tmNextTrigger=this.tmNextTrigger+t.tmIntervalTrigger,!0):!1},t.tmDelayFirstTrigger=400,t.tmIntervalTrigger=80,t}();t.TouchTriggerUnit=i,egret.registerClass(i,"city.touch.TouchTriggerUnit")}(i=t.touch||(t.touch={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(){function t(){}var i=(__define,t);i.prototype;return t.removeElem=function(t,i){var e=i.indexOf(t);return-1!=e?(i.splice(e,1),!0):!1},t.shuffle=function(t){for(var i=t.length-1;i>-1;--i){var e=Math.floor(t.length*Math.random()),n=t[i];t[i]=t[e],t[e]=n}},t.getRdmElem=function(t,i,e,n){void 0===i&&(i=!1),void 0===e&&(e=0),void 0===n&&(n=-1),-1==n&&(n=t.length);var r=n-e,s=this.getRdmIdx(r,e);return i?t.splice(s,1)[0]:t[s]},t.getRdmIdx=function(t,i){return void 0===i&&(i=0),i+Math.floor(Math.random()*t)},t.getSeriesNumArr=function(t,i){if(void 0===i&&(i=0),0>=t)return[];for(var e=new Array,n=i+t-1;n>=i;--n)e.unshift(n);return e},t}();t.ArrayUtil=i,egret.registerClass(i,"city.utils.ArrayUtil")}(i=t.utils||(t.utils={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(){function t(){}var i=(__define,t);i.prototype;return t.updateURL=function(t){window.open(t,"_self")},t.refreshSelf=function(){location.reload()},t}();t.BrowserUtil=i,egret.registerClass(i,"city.utils.BrowserUtil")}(i=t.utils||(t.utils={}))}(city||(city={}));var city;!function(t){var i;!function(i){var e=function(){function e(){}var n=(__define,e);n.prototype;return e.trace=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];console.log(t.join(" "))},e.traceInHtml=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];document.getElementById("info")&&(this.htmlDebug+=t.join(" ")+"<br>",document.getElementById("info").innerHTML=this.htmlDebug)},e.parseUpMysticalVisual=function(t){for(var e=new Array;t;)e.push(t+(t.name?" n:"+t.name:"")+" a:"+t.alpha+" v:"+t.visible+" x:"+t.x+" y:"+t.y+" w:"+t.width+" h:"+t.height),t=t.parent;for(var n="--- --- --- parseMysticalVisual:",r=e.length-1;r>-1;--r)n+="\n"+i.StringUtil.getRepeatString("	",e.length-r)+e[r];return n=n},e.viewThru=function(t,i,e,n,r){if(void 0===i&&(i=!1),void 0===e&&(e=1),void 0===n&&(n=3),void 0===r&&(r=""),!t)return"";var s=!1,o="";1==e&&(o+="\n┯┯┯┯┯┯┯┯┯┯┯┯┯┯┯┯┯\n");var a=0;for(var c in t)if(s=!0,0!=c.indexOf("_")){var h=t[c],l=typeof h;if("function"!=l){var u=null!=h?h+" ("+l+")":"<未定义>",d=i?this.getBrief(u.toString(),24,20,10,!1):u,g=" "+c+" :"+d;if(o+=this.getIndent(e)+g+"\n",null!=h&&n>e&&(o+=this.viewThru(h,i,e+1,n)),++a>9){o+=this.getIndent(e)+"......\n";break}}}return 1==e&&(o+="┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷"),s?o:""},e.getIndent=function(t){for(var i="",e=t;e>1;--e)i+=" │";return i+" ├"},e.getBrief=function(t,i,e,n,r){return void 0===i&&(i=600),void 0===e&&(e=600),void 0===n&&(n=20),void 0===r&&(r=!0),t.length<=i+e+n?t:r?t.slice(0,t.slice(0,i).lastIndexOf("\n"))+"\n\n	... ... ...\n\n"+t.slice(-e+t.slice(-e).indexOf("\n")+1):t.slice(0,i)+"... ..."+t.slice(-e)},e.resetDebugMark=function(){this.clearDebugMark(),null==this._aDebugPoint&&(this._aDebugPoint=new Array)},e.placeDebugMark=function(i,e,n,r,s){void 0===s&&(s=1);var o;o=new t.disp.Mark(65535,i),o.anchorOffsetX=o.anchorOffsetY=.5*o.width,o.x=e,o.y=n,o.alpha=s,r.addChild(o),null==this._aDebugPoint&&(this._aDebugPoint=new Array),this._aDebugPoint.push(o)},e.clearDebugMark=function(){if(this._aDebugPoint&&this._aDebugPoint.length)for(var t;this._aDebugPoint.length;)t=this._aDebugPoint.pop(),t&&t.parent&&t.parent.removeChild(t)},e.bezier=function(t,i,e,n,r,s,o,a){var c=1-t,h=t*t,l=2*t*c,u=c*c;a.x=h*i+l*n+u*s,a.y=h*e+l*r+u*o},e.htmlDebug="",e}();i.DevUtil=e,egret.registerClass(e,"city.utils.DevUtil")}(i=t.utils||(t.utils={}))}(city||(city={}));var city;!function(t){var i;!function(i){var e=function(){function i(){}var e=(__define,i);e.prototype;return i.layoutButtonHasId=function(t,i,e,n,r,s,o){void 0===o&&(o=.5),i.id=t,i.anchorOffsetX=o,i.anchorOffsetY=o,i.x=e,i.y=n,i.touchEnabled=!0,s&&i.addEventListener(egret.TouchEvent.TOUCH_TAP,s,r),r.addChild(i)},i.layoutTxButtonHasId=function(t,i,e,n,r,s,o,a,c,h){void 0===c&&(c=20),void 0===h&&(h=.5),i.id=t,i.fontFamily="Verdana",i.textColor=0,i.size=c,i.stroke=1.2,i.anchorOffsetX=h*i.width,i.anchorOffsetY=h*i.height,i.x=n,i.y=r,i.textAlign=egret.HorizontalAlign.LEFT,i.text=e,i.cacheAsBitmap=!0,o?(i.strokeColor=0,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,o,a),i.textColor=16777215):(i.strokeColor=6710886,i.touchEnabled=!1,i.textColor=16777215),s.addChild(i)},i.createBitmapByName=function(i){var e=new egret.Bitmap,n=t.assets.StrongAssets.extract(i);return e.texture=n,e},i}();i.DispUtil=e,egret.registerClass(e,"city.utils.DispUtil")}(i=t.utils||(t.utils={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(){function t(){}var i=(__define,t);i.prototype;return t.adjustDispWithCen=function(t,i){i.x=t.x-.5*i.width-i.anchorOffsetX+this.TEXT_MATRIX_ADJUST_X,i.y=t.y-.5*i.height-i.anchorOffsetY+this.TEXT_MATRIX_ADJUST_Y},t.TEXT_MATRIX_ADJUST_X=8,t.TEXT_MATRIX_ADJUST_Y=8,t}();t.GeomUtil=i,egret.registerClass(i,"city.utils.GeomUtil")}(i=t.utils||(t.utils={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(){function t(){}var i=__define,e=t;e.prototype;return i(t,"getOne",function(){return++this.count,"obj_"+this.count}),t.count=0,t}();t.Namer=i,egret.registerClass(i,"city.utils.Namer")}(i=t.utils||(t.utils={}))}(city||(city={}));var city;!function(t){var i;!function(t){var i=function(){function t(){}var i=__define,e=t;e.prototype;return t.getRepeatString=function(t,i){if(0>=i)throw new Error("lenth must >= 0!");for(var e=t,n=i;n>1;--n)e=t+e;return e},t.charIsNum=function(t){return t>="0"&&"9">=t},t.charIsLower=function(t){return t>="a"&&"z">=t},t.charIsUpper=function(t){return t>="A"&&"Z">=t},i(t,"urlRandomPostfix",function(){return"?pfr="+egret.getTimer().toString()+Math.ceil(1e5*Math.random())}),t}();t.StringUtil=i,egret.registerClass(i,"city.utils.StringUtil")}(i=t.utils||(t.utils={}))}(city||(city={}));var game;!function(t){var i;!function(t){var i=function(i){function e(){i.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,i);var n=(__define,e),r=n.prototype;return r.onAddToStage=function(t){this.loadingView=new city.disp.LoadingUI(this.stage.stageWidth,this.stage.stageHeight),this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/resource.json","resource/")},r.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preload")},r.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.createGameScene())},r.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},r.createGameScene=function(){t.GameCore.$i.launch(this)},e}(egret.DisplayObjectContainer);t.Bootstrap=i,egret.registerClass(i,"game.jumper.Bootstrap")}(i=t.jumper||(t.jumper={}))}(game||(game={}));var game;!function(t){var i;!function(t){var i=function(t){function i(){t.call(this),this.PLAYER_VY=-50,this.PLAYER_VX=32,this.WORLD_STEP_DT=2.5,this.GRAVITY=1.6,this._bDispReal=!0}__extends(i,t);var e=__define,n=i,r=n.prototype;return r.touchProcess=function(t){this._pbPlayer&&(city.key.KeyManager.isDown(city.key.KeyManager.Alt_L)?this.debugLogLoc(Math.floor(t.stageX),Math.floor(t.stageY)):t.stageY>750?t.stageX<240?this._pbPlayer.velocity[0]=-this.PLAYER_VX:this._pbPlayer.velocity[0]=this.PLAYER_VX:city.phys.P2Space.checkIfCanJump(this._pw,this._pbPlayer)?(this._pbPlayer.velocity[0]=this.PLAYER_VX*(t.stageX-240)/200,this._pbPlayer.velocity[1]=this.PLAYER_VY,console.log("jump speed:",this._pbPlayer.velocity)):city.utils.DevUtil.trace("player no jump:",this._pbPlayer.velocity[1]))},r.run=function(t){this._pw.step(this.WORLD_STEP_DT),this._vcGroundsFloating[0].position[0]>this._p2FloatingLimitRight&&(this._vcGroundsFloating[0].position[0]=this._p2FloatingLimitLeft),this._vcGroundsFloating[1].position[0]<this._p2FloatingLimitLeft&&(this._vcGroundsFloating[1].position[0]=this._p2FloatingLimitRight),this._vcGroundsFloating[2].position[0]>this._p2FloatingLimitRight&&(this._vcGroundsFloating[2].position[0]=this._p2FloatingLimitLeft),this._bDispReal?(city.phys.P2Space.syncDisplay(this._pbPlayer),city.phys.P2Space.syncDisplay(this._vcGroundsFloating[0]),city.phys.P2Space.syncDisplay(this._vcGroundsFloating[1]),city.phys.P2Space.syncDisplay(this._vcGroundsFloating[2])):this._p2DebugPainter.drawDebug()},r.setDev=function(){},r.initDebug=function(){this._txTouchStatus=new city.disp.TxButtonHasId,city.utils.DispUtil.layoutTxButtonHasId(-1,this._txTouchStatus,"",280,3,this,null,null,28,0)},r.createWorldSystem=function(){if(city.phys.P2Space.initSpace(1,new egret.Rectangle(0,0,this.stage.stageWidth,this.stage.stageHeight)),this._p2FloatingLimitLeft=city.phys.P2Space.extentP2(-100),this._p2FloatingLimitRight=city.phys.P2Space.extentP2(this.stage.stageWidth+100),this._pw=new p2.World,this._pw.defaultContactMaterial.friction=.5,this._pw.setGlobalStiffness(1e3),this._pw.gravity[1]=this.GRAVITY,city.utils.DevUtil.trace("gravity:",this._pw.gravity[0],this._pw.gravity[1]),this._vcGroundsFixed=[this.createGround(this._pw,this,1,0,640,50,"rects.rect-9",0,750,"地面"),this.createGround(this._pw,this,2,0,50,750,"rects.rect-1",0,0,"左墙面"),this.createGround(this._pw,this,3,0,50,750,"rects.rect-1",430,0,"右墙面")],this._vcGroundsFloating=[this.createGround(this._pw,this,4,.6,120,20,"rects.rect-0",this._p2FloatingLimitLeft,600),this.createGround(this._pw,this,5,-.8,90,20,"rects.rect-8",this._p2FloatingLimitRight,450),this.createGround(this._pw,this,6,1.2,80,20,"rects.rect-10",this._p2FloatingLimitLeft,300)],this._bDispReal)city.phys.P2Space.syncDisplay(this._vcGroundsFixed[0],"地面"),city.phys.P2Space.syncDisplay(this._vcGroundsFixed[1]),city.phys.P2Space.syncDisplay(this._vcGroundsFixed[2]);else{var t=new egret.Sprite;t.name="spDebug",this.addChild(t),t.graphics.beginFill(0,.3),t.graphics.drawRect(0,0,this.stage.stageWidth,this.stage.stageHeight),t.graphics.endFill(),this._p2DebugPainter=new city.phys.P2DebugPainter(this._pw,t)}this._pbPlayer=this.createPlayer(this._pw,this,0,"kuchipatchi1.png",200,700),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchProcess,this,!1)},r.createPlayer=function(t,i,e,n,r,s){var o=new p2.Body({mass:1,fixedRotation:!0,type:p2.Body.DYNAMIC});o.id=e,t.addBody(o);var a=city.utils.DispUtil.createBitmapByName(n);a.anchorOffsetX=.5*a.width,a.anchorOffsetY=.5*a.height;var c=new p2.Box({width:city.phys.P2Space.extentP2(a.texture.textureWidth),height:city.phys.P2Space.extentP2(a.texture.textureHeight)});return o.addShape(c),o.position=city.phys.P2Space.getP2Pos(r,s-a.texture.textureHeight/2),this._p2posYPlayerLanding=o.position[1],this._bDispReal&&(o.displays=[a],i.addChild(a)),o},r.createGround=function(t,i,e,n,r,s,o,a,c,h){void 0===h&&(h="");var l=new p2.Body({mass:1,fixedRotation:!0,position:city.phys.P2Space.getP2Pos(a+r/2,c+s/2),type:0==n?p2.Body.STATIC:p2.Body.KINEMATIC,velocity:[n,0]});l.id=e,t.addBody(l);var u=new p2.Box({width:city.phys.P2Space.extentP2(r),height:city.phys.P2Space.extentP2(s)});if(l.addShape(u),h.length&&console.log("[createGround] - "+h+" 位置：",l.position[0],l.position[1],"大小:",u.width,u.height),this._bDispReal){var d=city.utils.DispUtil.createBitmapByName(o);d.width=r,d.height=s,d.anchorOffsetX=.5*d.width,d.anchorOffsetY=.5*d.height,l.displays=[d],i.addChild(d)}return l},r.launch=function(t){t.addChild(this),city.key.KeyManager.init(),this.initDebug(),this.createWorldSystem(),this.stage.frameRate=20,this.addEventListener(egret.Event.ENTER_FRAME,this.run,this)},r.debugLogLoc=function(t,i){this._txTouchStatus.text="["+t+","+i+"]"},e(i,"$i",function(){return null==this._i&&(this._i=new i),this._i}),i}(egret.Sprite);t.GameCore=i,egret.registerClass(i,"game.jumper.GameCore")}(i=t.jumper||(t.jumper={}))}(game||(game={}));